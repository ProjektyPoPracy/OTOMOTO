version
library(rvest)
version
library(tidyverse)
options(stringsAsFactors = FALSE)
?html
URL <- paste0(URL.core, URL.suffix, pageNumber)
URL.core <- "https://www.otomoto.pl/osobowe/uzywane/"
URL.suffix <- "?page="
pageNumber <- 1
URL <- paste0(URL.core, URL.suffix, pageNumber)
site <- rvest::html(URL)
site <- rvest::html(URL) %>%
rvest::html_nodes(xpath = "\\a[@class='offer-title__link']")
site <- read_html(URL) %>%
rvest::html_nodes(xpath = "\\a[@class='offer-title__link']")
??read_html
library(xml2)
site <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "\\a[@class='offer-title__link']")
site <- xml2::read_html(URL)
site
site <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "//div/a[@class='offer-title__link']")
site <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "//div/h2/a[@class='offer-title__link']")
site <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "//div/h2/a[@class='offer-title__link']") %>%
rvest::html_attrs()
site
site <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "//div/h2/a[@class='offer-title__link']") %>%
rvest::html_attr(name = "href")
site
rm(site)
offer.URLs <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "//div/h2/a[@class='offer-title__link']") %>%
rvest::html_attr(name = "href")
offer.URL <- offer.URLs[20]
?html_table
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']") %?%
rvest::html_table()
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']") %>%
rvest::html_table()
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']") %>%
rvest::html_form()
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']") %>%
rvest::html_text()
parameters.table
?strsplit()
x <- strsplit(parameters.table,
split = "\n")
x <- strsplit(parameters.table,
split = "\\\n")
x <- strsplit(parameters.table,
split = "\\n")
x <- strsplit(parameters.table,
split = "//\n")
x <- strsplit(parameters.table,
split = "/\n")
x <- strsplit(parameters.table,
split = "n")
parameters.table
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']") %>%
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']")
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']")
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']")
labels <- parameters.table %>%
rvest::html_nodes(xpath = "/ul/li/span[@class='offer-params__label']")
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']")
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']") %>%
rvest::html_text()
labels
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']") %>%
rvest::html_text() %>%
gsub(pattern = " ", replacement = ".", x = .)
labels
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__value']") %>%
rvest::html_text()
values
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__value']/a") %>%
rvest::html_text()
values
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__value']/a")
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']/a") %>%
rvest::html_text()
values
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']") %>%
rvest::html_text() %>%
gsub(pattern = " ", replacement = ".", x = .)
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']/a") %>%
rvest::html_text()
labels
values
offer.URL
offer.URLs
offer.URL
labels
values
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']/a or //ul/li/div[@class='offer-params__value']") %>%
rvest::html_text()
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']/a | //ul/li/div[@class='offer-params__value']") %>%
rvest::html_text()
labels
values
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']") %>%
rvest::html_text()
labels
values
gsub(pattern = "\n| {2+}|^ | $",x = values)
gsub(pattern = "\n| {2+}|^ | $", replacement = "",x = values)
gsub(pattern = "\\n| {2+}|^ | $", replacement = "",x = values)
gsub(pattern = "\\n", replacement = "",x = values)
gsub(pattern = "\\s{2+}|^ | $", replacement = "",x = values)
gsub(pattern = "\\s{2+}|^\\s|\\s$", replacement = "",x = values)
gsub(pattern = "\\s", replacement = "",x = values)
gsub(pattern = "\\s+", replacement = "",x = values)
gsub(pattern = "\\s{2}", replacement = "",x = values)
gsub(pattern = "\\s{2+}", replacement = "",x = values)
gsub(pattern = "\\s{2-1000000}", replacement = "",x = values)
gsub(pattern = "\\s{2,}", replacement = "",x = values)
gsub(pattern = "\\s{2,}", replacement = "",x = values)
labels
gsub(pattern = "\\s{2,}", replacement = "",x = values)
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
labels
values
length(labels)==length(values)
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='offer-features__row']/ul/li/span") %>%
rvest::html_text()
equipment
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='offer-features__row']/ul/li/span")
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='offer-features__row']/ul/li/span")
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='offer-features__row']/ul/li")
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-features__row']/ul[@class='']/li[@class='']")
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-features__row']/ul[@class='offer-features__list']/li[@class='offer-features__item']") %>%
rvest::html_text()
equipment
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-features__row']/ul[@class='offer-features__list']/li[@class='offer-features__item']") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
equipment
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@data-text='Pokaż pełny opis']")
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div")
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text()
description
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text()
x <-
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
x
description
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item']/span[@class='offer-meta__value']") %>%
rvest::html_text()
offer.id
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item']/span[@class='offer-meta__value'][2]") %>%
rvest::html_text()
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']") %>%
rvest::html_text() %>%
gsub(pattern = " ", replacement = ".", x = .)
offer.id
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item']/span[@class='offer-meta__value'][1]") %>%
rvest::html_text()
offer.id
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item'][1]/span[@class='offer-meta__value']") %>%
rvest::html_text()
offer.id
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item'][2]/span[@class='offer-meta__value']") %>%
rvest::html_text()
offer.id
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item']/span[@class='offer-meta__value']") %>%
rvest::html_text()
offer.id
version
# platform       x86_64-pc-linux-gnu
# arch           x86_64
# os             linux-gnu
# system         x86_64, linux-gnu
# status
# major          3
# minor          4.4
# year           2018
# month          03
# day            15
# svn rev        74408
# language       R
# version.string R version 3.4.4 (2018-03-15)
# nickname       Someone to Lean On
options(stringsAsFactors = FALSE)
library(tidyverse)
library(xml2)
URL.core <- "https://www.otomoto.pl/osobowe/uzywane/"
URL.suffix <- "?page="
pageNumber <- 1
URL <- paste0(URL.core, URL.suffix, pageNumber)
offer.URLs <- xml2::read_html(URL) %>%
rvest::html_nodes(xpath = "//div/h2/a[@class='offer-title__link']") %>%
rvest::html_attr(name = "href")
offer.URL <- offer.URLs[20]
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']")
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item']/span[@class='offer-meta__value']") %>%
rvest::html_text()
offer.id
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']") %>%
rvest::html_text() %>%
gsub(pattern = " ", replacement = ".", x = .)
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
labels
values
length(labels)==length(values)
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-features__row']/ul[@class='offer-features__list']/li[@class='offer-features__item']") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
equipment
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
description
offer.URL
parameters.table
offer.id
labels
values
length(labels)==length(values)
one.offer <- data.frame(
Id = rep(offer.id, n),
Label = c(labels, equipment, "description"),
Value = c(values, rep(1, n_equipment), description)
)
## Połączenie informacji:
offer.id
length(labels)==length(values)
labels
values
equipment
description
n <- length(labels) + length(equipment) + 1
n_equipment <- length(equipment)
one.offer <- data.frame(
Id = rep(offer.id, n),
Label = c(labels, equipment, "description"),
Value = c(values, rep(1, n_equipment), description)
)
one.offer
View(one.offer)
offer.id
one.offer <- data.frame(
Id = rep(offer.id[2], n),
Label = c(labels, equipment, "description"),
Value = c(values, rep(1, n_equipment), description)
)
one.offer
one.offer <- data.frame(
Id = rep(offer.id[2], n),
Label = c(labels, equipment, "Opis"),
Value = c(values, rep(1, n_equipment), description)
)
one.offer <- data.frame(
Id = rep(offer.id[2], n),
Date = rep(offer.id[1], n),
Label = c(labels, equipment, "Opis"),
Value = c(values, rep(1, n_equipment), description)
)
one.offer <- data.frame(
Id = rep(offer.id[2], n),
Label = c(labels, equipment, "Opis", "Data.oferty"),
Value = c(values, rep(1, n_equipment), description, offer.id[1])
)
ffer.id[1]
offer.id[1]
n <- length(labels) + length(equipment) + 2
n_equipment <- length(equipment)
one.offer <- data.frame(
Id = rep(offer.id[2], n),
Label = c(labels, equipment, "Opis", "Data.oferty"),
Value = c(values, rep(1, n_equipment), description, offer.id[1])
)
one.offer
offer.URL <- "https://www.otomoto.pl/oferta/mercedes-benz-w124-1984-1993-coupe-300ce-ID6AmpFl.html#3471ec01f4"
parameters.table <- xml2::read_html(offer.URL) %>%
rvest::html_node(xpath = "//div[@id='parameters']")
offer.id <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-content__metabar']/div[@class='offer-meta']/span[@class='offer-meta__item']/span[@class='offer-meta__value']") %>%
rvest::html_text()
offer.id
labels <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/span[@class='offer-params__label']") %>%
rvest::html_text() %>%
gsub(pattern = " ", replacement = ".", x = .)
values <- parameters.table %>%
rvest::html_nodes(xpath = "//ul/li/div[@class='offer-params__value']") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
labels
values
length(labels)==length(values)
equipment <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@class='offer-features__row']/ul[@class='offer-features__list']/li[@class='offer-features__item']") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
equipment
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\s{2,}", replacement = "", x = .)
description
## Połączenie informacji:
offer.id
length(labels)==length(values)
labels
values
equipment
description
n <- length(labels) + length(equipment) + 2
n_equipment <- length(equipment)
one.offer <- data.frame(
Id = rep(offer.id[2], n),
Label = c(labels, equipment, "Opis", "Data.oferty"),
Value = c(values, rep(1, n_equipment), description, offer.id[1])
)
one.offer
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text()
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\n", replacement = "", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .) %>%
gsub(pattern = "\\", replacement = "", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text()
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .) %>%
gsub(pattern = "\\\"", replacement = "", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .) %>%
gsub(pattern = "\\\"", replacement = "", x = .) %>%
gsub(pattern = "^\\s{2,}", replacement = " ", x = .) %>%
gsub(pattern = "\\s{2,}$", replacement = " ", x = .) %>%
gsub(pattern = "\\s{2,}", replacement = " ", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .) %>%
gsub(pattern = "\\\"", replacement = "", x = .) %>%
gsub(pattern = "^\\s{2,}", replacement = "", x = .) %>%
gsub(pattern = "\\s{2,}$", replacement = "", x = .) %>%
gsub(pattern = "\\s{2,}", replacement = " ", x = .)
description
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .) %>%
gsub(pattern = "\\\"", replacement = "'", x = .) %>%
gsub(pattern = "^\\s{2,}", replacement = "", x = .) %>%
gsub(pattern = "\\s{2,}$", replacement = "", x = .) %>%
gsub(pattern = "\\s{2,}", replacement = " ", x = .)
description
offer.URL <- offer.URLs[20]
description <- xml2::read_html(offer.URL) %>%
rvest::html_nodes(xpath = "//div[@id='description']/div") %>%
rvest::html_text() %>%
gsub(pattern = "\\n", replacement = "", x = .) %>%
gsub(pattern = "\\r", replacement = "", x = .) %>%
gsub(pattern = "\\\"", replacement = "'", x = .) %>%
gsub(pattern = "^\\s{2,}", replacement = "", x = .) %>%
gsub(pattern = "\\s{2,}$", replacement = "", x = .) %>%
gsub(pattern = "\\s{2,}", replacement = " ", x = .)
description
